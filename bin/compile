#!/bin/sh

#  Usage:
#  -------
#    bin/compile BUILD_DIR CACHE_DIR ENV_DIR
#
#      -  `BUILD_DIR` will be the location of the app
#
#      -  `CACHE_DIR` will be the locaiton the buildpack can use to cache build
#         artifacts between builds
#
#      -  `ENV_DIR` is a directory that contains a file for each of the app's
#         configuration variables
#
#  Link(s):
#  -------
#   https://devcenter.heroku.com/articles/buildpack-api
#
#  Note(s):
#  -------
#    This script performs the buildpack transformation.
#    All output received on `stdout` will be displayed to the user.

# Parse args
BUILD_DIR=$1
CACHE_DIR=$2
ENV_DIR=$3

# Create the cache dir if it doesn't exist
mkdir -p $CACHE_DIR

# Install zip
echo "-----> Installing zip..."
curl --location https://www.dropbox.com/s/zg3h7bbf21uw0ec/zip-binary.tar.gz | tar xz
mkdir -p $BUILD_DIR/vendor
mv zip $BUILD_DIR/vendor/zip

#curl http://ftp.osuosl.org/pub/ubuntu/pool/main/z/zip/zip_3.0-7_amd64.deb > $CACHE_DIR/zip_3.0-7_amd64.deb
#dpkg -i $CACHE_DIR/zip_3.0-7_amd64.deb
